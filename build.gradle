apply plugin: 'scala'

ext {
  scalaMajorVersion = '2.11'
  scalaVersion = scalaMajorVersion+'.6'
  akkaVersion = '2.3.11'
  configVersion = '1.3.0'
  ESVersion = '1.6.0'
  LuceneVersion = '4.10.4'
  cassandraVersion = '2.2.0-rc1'//'2.1.6'
  nettyVersion = '4.0.27.Final'
}

repositories {
  mavenLocal()
  mavenCentral()
}

configurations {
  cassandra
  elasticsearch
  mongo
}

dependencies {
  compile "org.scala-lang:scala-library:$scalaVersion",
          "com.typesafe.akka:akka-actor_$scalaMajorVersion:$akkaVersion",
          "com.typesafe.akka:akka-slf4j_$scalaMajorVersion:$akkaVersion",
          "com.typesafe:config:$configVersion",
          configurations.cassandra,
          configurations.elasticsearch,
          configurations.mongo

  cassandra "com.datastax.cassandra:cassandra-driver-core:$cassandraVersion",
            "io.netty:netty-all:$nettyVersion"

  elasticsearch "org.elasticsearch:elasticsearch:$ESVersion",
                "org.apache.lucene:lucene-core:$LuceneVersion"

  mongo 'org.mongodb:mongo-java-driver:3.0.3',
        'org.jongo:jongo:1.2',
        'de.undercouch:bson4jackson:2.4.0'
              
} 

task run(type: JavaExec, dependsOn: 'build') {
  classpath configurations.compile, "$buildDir/classes/main"
  main 'ap.loader.akka.Main'
  systemProperty 'loader', project.hasProperty('loader') ? project.getProperty('loader') : 'cassandra'
  systemProperty 'nbPar', project.hasProperty('nbPar') ? project.getProperty('nbPar') : '1'
  systemProperty 'nbMsg', project.hasProperty('nbMsg') ? project.getProperty('nbMsg') : '1'
  systemProperty 'payloadSize', project.hasProperty('payloadSize') ? project.getProperty('payloadSize') : '1'
}

